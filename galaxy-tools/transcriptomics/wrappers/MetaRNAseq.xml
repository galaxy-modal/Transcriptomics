<tool id="metarnaseq" name="metaRNASeq">
	<description>metaRNASeq wrapper</description>
	<requirements>
	  <container type="docker">sblanck/testtool:latest</container>
	</requirements>
	<command>

		/galaxy-tools/stderr_wrapper.py Rscript 
		/galaxy-tools/transcriptomics/MetaRNASeq/MetaRNASeq.R 
		#for $currentInput in $inputList
        	${currentInput}
		 #end for	
			$comparison 
			$method 
			$mod 
			$top_table 
			$diagnostic_html 
			"$diagnostic_html.files_path"
		/galaxy-tools/transcriptomics/MetaRNAseq/MetaRNASeq_tpl.html	
	</command>

	<inputs>
		<param format="tabular" name="inputList" multiple="true" type="data" optional="false" label="Counts file" help="Must have the same number of row in each study. The experimental conditions must be specified in the header of each file"/>

		<param name="method" type="select" label="Compute dispersion method" help="">
			<option value="pooled">Pooled</option>
			<option value="pooled-CR">Pooled-CR</option>
			<option value="per-condition">Per-condition</option>
			<option value="blind">Blind</option>
		</param>
		<param name="mod" type="select" label="Compute dispersion sharingmod" help="">
			<option value="maximum">Maximum</option>
			<option value="fit-only">Fit-only</option>
			<option value="gene-est-only">Gene-est-only</option>
		</param>

		<param name="comparison" type="text" size="30" optional="false" label="Comparison type" help="A comma separated tuple (no spaces) of the comparison you want to do.  Must use the names from the Column Types list.  E.g. comparing kidney to liver: kidney,liver.  Comparing liver to kidney: liver,kidney">
			<validator type="empty_field"/>
			<validator type="regex" message="Must be a comma-separated tuple with no spaces">^\w+,\w+$</validator>
		</param>
	</inputs>

	<outputs>
		<data format="tabular" name="top_table" label="Summary of meta-analysis and single studie analysis from ${tool.name} on ${on_string}"/>
		<data format="html" name="diagnostic_html" label="Charts for ${tool.name} on ${on_string}"/>
	</outputs>

	<help>
		NOTE: This metaRNASeq Galaxy tool can only be run on counts files. 
	</help>

</tool>
